<!DOCTYPE html>
<html>
	<head>
		<title>xkcd #1313: Regex Golf</title>
		<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body>
		<div class="container center-block" style="margin-top:3em">
			<div class="row">
				<form class="col-xs-12">
					<div>
						<label class="control-label" for="regex">Regular Expression (<span>10</span> characters)</label>
						<input id="regex" class="form-control input-lg" value="m | [tn]|b" disabled>
					</div>
					<div class="checkbox">
						<label>
							<input id="case" type="checkbox" checked disabled> Case Insensitive
						</label>
					</div>
				</form>
			</div>
			<table class="table" style="margin-top:3em">
				<thead>
					<tr>
						<th>Star Wars</th>
						<th>Star Trek</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td class="success">A New Hope</td>
						<td>The Motion Picture</td>
					</tr>
					<tr>
						<td class="success">The Empire Strikes Back</td>
						<td>The Wrath of Khan</td>
					</tr>
					<tr>
						<td class="success">Return of the Jedi</td>
						<td>The Search for Spock</td>
					</tr>
					<tr>
						<td class="success">The Phantom Menace</td>
						<td>The Voyager Home</td>
					</tr>
					<tr>
						<td class="success">Attack of the Clones</td>
						<td>The Final Frontier</td>
					</tr>
					<tr>
						<td class="success">Revenge of the Sith</td>
						<td>The Undiscovered Country</td>
					</tr>
					<tr>
						<td>The Clone Wars</td>
						<td>Generations</td>
					</tr>
					<tr>
						<td></td>
						<td>First Contact</td>
					</tr>
					<tr>
						<td></td>
						<td>Insurrection</td>
					</tr>
					<tr>
						<td></td>
						<td>Nemesis</td>
					</tr>
					<tr>
						<td></td>
						<td class="danger">Star Trek</td>
					</tr>
					<tr>
						<td></td>
						<td>Into Darkness</td>
					</tr>
				</tbody>
			</table>
		</div>
		<script>
			(function(){
				'use strict';
				var titles = document.getElementsByTagName('td'),
				    input = document.getElementById('regex'),
				    mode = document.getElementById('case'),
				    count = document.getElementsByTagName('span')[0],
				    l = titles.length;
				mode.onchange = check; mode.removeAttribute('disabled');
				input.onkeyup = check; input.removeAttribute('disabled');
				function check() {
					var regex, solution = input.value, text;
					try { count.textContent = solution.length } catch (e) { count.innerText = solution.length }
					try {
						regex = new RegExp(solution === '' ? '(?!)' : solution, mode.checked ? 'i' : '');
						input.parentNode.className = '';
					} catch (e) {
						input.parentNode.className = 'has-error';
						return;
					}
					for (var i=0;i<l;i++) {
						text = titles[i].textContent || titles[i].innerText;
						if (text.length > 0 && regex.test(text)) titles[i].className = i%2 ? 'danger' : 'success';
						else titles[i].className = '';
					}
				}
			})()
		</script>
	</body>
</html>
